---
title: "DSFinal"
author: "Dhairya, Varun, Siddhartha, Subham"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
```

```         
DataSet origin: https://archive.ics.uci.edu/dataset/2/adult
```

```{r}
# Read the dataset from the URL
data <- read.csv("https://archive.ics.uci.edu/ml/machine-learning-databases/adult/adult.data")
```

```{r}
#cleaning Data
data <- data %>% rename(age = X39,workclass = State.gov,final_weight = X77516,education = Bachelors,education_num = X13,maritial_status = Never.married, relationship = Not.in.family, occupation = Adm.clerical, race = White, sex = Male,capital_gain = X2174,capital_loss = X0,hours_per_week = X40, native_country = United.States, income = X..50K)

#trim data values
data <- data %>%
  mutate(across(everything(), trimws))

#change ? values to NA
data <- data %>%mutate(
  workclass = ifelse(workclass == "?",NA,workclass),
  occupation = ifelse(occupation == "?",NA,occupation),
  native_country = ifelse(native_country == "?",NA,native_country)) 

#reorder education column values
data$education <- factor(data$education, levels = c("Preschool", "1st-4th", "5th-6th", "7th-8th", "9th", "10th", "11th", "12th", "HS-grad", "Some-college", "Assoc-acdm", "Assoc-voc", "Bachelors", "Masters", "Prof-school", "Doctorate"))

#changing datatype
data$occupation <- as.factor(data$occupation)
data$workclass <- as.factor(data$workclass)
data$maritial_status <- as.factor(data$maritial_status)
data$relationship <- as.factor(data$relationship)
data$sex <- as.factor(data$sex)
data$race <- as.factor(data$race)
data$native_country <- as.factor(data$native_country)
data$income <- as.factor(data$income)


data$age <- as.numeric(data$age)
data$education_num <- as.numeric(data$education_num)
data$capital_gain <- as.numeric(data$capital_gain)
data$capital_loss <- as.numeric(data$capital_loss)
data$hours_per_week <- as.numeric(data$hours_per_week)

```

```         
The paramters are:

age: the age of an individual
workclass: a general term to represent the employment status of an individual
final_weight: final weight. This is the number of people the census believes the entry represents..
education: the highest level of education achieved by an individual.
education_num: the highest level of education achieved in numerical form.
marital_status: marital status of an individual.
occupation: the general type of occupation of an individual
relationship: represents what this individual is relative to others.
race: Descriptions of an individualâ€™s race
sex: the sex of the individual
capital_gain: capital gains for an individual
capital_loss: capital loss for an individual
hours_per_week: the hours an individual has reported to work per week
native_country: country of origin for an individual
income: if the income of that person is less than or greater than 50,000
```

```{r}
summary(data)
```

```         
This shows that there are no missing values in the dataset, besides occupation,workclass and native_country which has certain missing values.
```

```{r}

#density plot for age
ggplot(data, aes(x = age)) +
  geom_bar(fill = "lightblue") +
  labs(x = "Age", y = "Count") +
  theme_minimal()
```

```         
This bar plot is left skewed which shows that majority of the working population in ranging from 20 to 50. 
```

```{r}
#number of observations where income <=50K
print(sum(data$income == "<=50K"))

#number of observations where income >50K
print(sum(data$income == ">50K"))
```

```{r}
ggplot(data, aes(x = education, fill = income)) +
  geom_bar(position = "fill") +
  labs(title = "Education Level V/S Income",x = "Education Level", y = "Proportion", fill = "Income") +
  theme_minimal()+
  theme(axis.text.x = element_text(angle =45,hjust=1))
```

```         
The above bar plot decribes the relation between Education Level and Income. The income values are of two type, <=50K and >50K. Majority of the population distribution has income less that 50K. percentage of population that has income <=50K is (24719/32560)*100 = 75.9%. However, from the bar plot we can see that as the level of education increases, the proportion of income shifts towards income levels greater than 50K. That is the ratio of >50K to <=50K increases. we can also see that for individuals with education level of Masters, Prof-school and Doctorate more than 50% of them have an income >50K. 
```